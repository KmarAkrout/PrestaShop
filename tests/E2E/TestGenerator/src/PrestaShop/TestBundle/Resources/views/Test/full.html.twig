

{% extends "PrestaShopTestBundle::layout.html.twig" %}

{% block title %}
  Full Test - {{ parent() }}
{% endblock %}

{% block prestaShopTest_body %}


<hr>
<script type="text/javascript">

function changeFunc() {
    document.getElementById("genBtn").disabled= false;
    var selectBox = document.getElementById("exampleFormControlSelect1");
    var selectedValue = selectBox.options[selectBox.selectedIndex].value;
    var DivToAdd = document.getElementById('IdDiv');
    var alert = document.getElementById('alertId');
    var alert1 = document.getElementById('alertId1');
    var DivToAdd1 = document.getElementById('parDIV');
    var selectedId= selectBox.options[selectBox.selectedIndex].id;
    var list;
    if(document.getElementById('li'+selectedId) != null)
    {list=document.getElementById('li'+selectedId).getAttribute('data-value');}
    else{
      list ="";
      
    }
    var res= list.split("***");
    var res1 = res[0].split("\n");
    var j;var z;
    var Sub;
    var res2;
    for(j=1;j<res.length;j++)
    {
    
    var n=res[j].lastIndexOf('.');
    
   
    Sub = res[j].substring(0, n+3);
    res2=Sub.split("\n");
    var concat;
    for(z=1;z<res2.length;z++)
    {
    
     concat=res2[0]+res2[z];
     var n1=concat.indexOf("/");
     var sub1=concat.substring(0, n1+1);
     var rep=concat.replace(sub1,'');
     var rep1 = rep.replace(":", "/");
     res1.push(rep1);
    }

    }
   
    
    
    
    if(document.getElementById('Myselect')==null && list!="")
    {
      var i;
    tempSelect = document.createElement('select');
    tempSelect.setAttribute("name","file");
    tempSelect.setAttribute("id","Myselect");
    tempSelect.setAttribute("class","form-control");
    //tempSelect.setAttribute("onchange","changeSel2()");
    DivToAdd1.appendChild(tempSelect);
    var extension;
    
    option0=document.createElement("option");
    option0.setAttribute("disabled","true");
    option0.setAttribute("selected","true");
    option0.setAttribute("value","");
    option0.innerHTML="-- choisir un fichier --";
    tempSelect.appendChild(option0);
    for (i = 1; i < res1.length; i++) { 
      extension = res1[i].slice(-3);
     
      if(res1[i]!= '' && res1[i].includes('.js'))
      {var option = document.createElement("option");
      option.value = res1[i];
      option.text = res1[i];
     
      tempSelect.appendChild(option);}
    }
    
    }
    else if(document.getElementById('Myselect')!=null && list!="")
    { 
     DivToAdd1.removeChild(tempSelect);
     var i;
     tempSelect = document.createElement('select');
     tempSelect.setAttribute("name","file");
     tempSelect.setAttribute("id","Myselect");
     tempSelect.setAttribute("class","form-control");
     //tempSelect.setAttribute("onchange","changeSel2()");
     DivToAdd1.appendChild(tempSelect);
     var extension;
     
    option0=document.createElement("option");
    option0.setAttribute("disabled","true");
    option0.setAttribute("selected","true");
    option0.setAttribute("value","");
    option0.innerHTML="-- choisir un fichier --";
    tempSelect.appendChild(option0);
     for (i = 1; i < res1.length; i++) { 
       extension = res1[i].slice(-3);
      
       if(res1[i]!= '' && res1[i].includes('.js'))
       {var option = document.createElement("option");
       option.value = res1[i];
       option.text = res1[i];
      
       tempSelect.appendChild(option);}
     }
     
    }
    else if(document.getElementById('Myselect')!=null && list=="")
    {
      DivToAdd1.removeChild(tempSelect);
      
    }
    
    if(selectedValue == '10_module')
    {
      alert1.hidden=false;
        lab = document.getElementById('labMod');
        inp = document.getElementById('module');
        DivToAdd.removeChild(lab);
        DivToAdd.removeChild(inp);
        label1 = document.createElement("Label");
        label1.innerHTML = "Module: (REQUIRED)";
        DivToAdd.appendChild(label1);

				tempInput1 = document.createElement('input');
				tempInput1.setAttribute("type","text");
        tempInput1.setAttribute("REQUIRED","TRUE");
        tempInput1.setAttribute("id","idInpMod");
				tempInput1.setAttribute("name","module");
        tempInput1.setAttribute("placeholder","Default to 'gadwords'");
        tempInput1.setAttribute("class","form-control");
				DivToAdd.appendChild(tempInput1);
        
    }
    else 
    if(document.getElementById('idInpMod')!=null){
       
       
       DivToAdd.removeChild(tempInput1);
       DivToAdd.removeChild(label1);
       alert1.hidden=true;
       
    }
    
   }
function generateCmd()
{
    var selectBox = document.getElementById("exampleFormControlSelect1");
    var path = selectBox.options[selectBox.selectedIndex].value;
    var selectBox2 = document.getElementById("Myselect");
    var file = selectBox2.options[selectBox2.selectedIndex];
    var dir=document.getElementById("dir");
    var module=document.getElementById("idInpMod");
    var url=document.getElementById("url");
    
   
if(file !== null)
{
  file="/"+file.value;
}
else 
{
  file="";
}
if (dir.value != "")
{
  dir=" --DIR="+dir.value;
}
else
{
  swal({
    title: "Attention !",
    text: "Vous n'avez pas specifié votre dossier de Téléchargements",
    icon: "error",
    button: "OK",
  });
  return false;
  
}
if(module != null)
{
  if(module.value != "")
  {
    module=" --MODULE="+module.value;
  }
  else
  {
    swal({
      title: "Attention !",
      text: "Vous n'avez pas specifié le Module",
      icon: "error",
      button: "D'accord",
    });
    return false;
    
  }
 
}
else{
  module="";
}
if (url.value != "")
{
  url=" --URL="+url.value;
}
else
{
  url="";
}
var cmd="path=full/"+path+file+" npm run specific-test --"+url+dir+module;
swal({
  title: "Votre commande est :",
  text: cmd,
  icon: "success",
  button: "D'accord",
});

}
function generateCmd1()
{
//////////*********///////////**********///
var dir1=document.getElementById("dir1").value;
var module1=document.getElementById("module1").value;
var url1=document.getElementById("url1").value;
////////************///////////********//////
if(url1 != "")
{
  url1=" --URL="+url1
}
if(module1 !="")
{
  module1=" --MODULE="+module1;
}
if(dir1 != "")
{
  dir1=" --DIR="+dir1;
}
else{
  swal({
    title: "Attention !",
    text: "Vous n'avez pas specifié votre dossier de Téléchargements",
    icon: "error",
    button: "D'accord",
  });
  return false;
  }
  var cmd1='npm run full-test --'+url1+dir1+module1;
swal({
  title: "Votre commande est :",
  text: cmd1,
  icon: "success",
  button: "D'accord",
});
}
</script>
<ul id="list1" hidden>
    {% set nb = 0 %}
  {% for file in list1 %}
  {% set nb = nb + 1 %}
 <li data-value="{{file}}" id="li{{ nb }}" hidden>{{file}}</li>
{% endfor %}
</ul>

<div class="row">
  <div class="col-4">
    <div class="list-group" id="list-tab" role="tablist">
      <a class="list-group-item list-group-item-action active" id="list-home-list" data-toggle="list" href="#list-home" role="tab" aria-controls="home">Full test complet</a>
      <a class="list-group-item list-group-item-action" id="list-profile-list" data-toggle="list" href="#list-profile" role="tab" aria-controls="profile">Full test spécifique</a>
      <a class="list-group-item list-group-item-action" id="list-messages-list" data-toggle="list" href="#list-messages" role="tab" aria-controls="messages">Informations utiles</a>
      
    </div>
  </div>
  <div class="col-8">
    <div class="tab-content" id="nav-tabContent">
      <div class="tab-pane fade show active" id="list-home" role="tabpanel" aria-labelledby="list-home-list">
        <div class="alert alert-info" role="alert">
          <h5 class="alert-heading"> <i class="fas fa-exclamation-circle"></i> Remarque:</h5><hr>
Il n'est pas recommandé d'exécuter tous les Full tests ensemble, il est plus sûr de les exécuter un par un en utilisant le test spécifique !
        </div>
      <form action="{{path('prestaShop_test_aff_full')}}" id="divTest" class="form-horizontal">
      
      <div class="form-group">
      <label for="exampleFormControlInput1">DIR :(REQUIRED)</label>
      <input type="text" class="form-control" id="dir1" placeholder="Votre dossier de Téléchargements (exp: /home/toto/Downloads/)" name="dir" REQUIRED>
     </div>
      <div class="form-group">
      <label for="exampleFormControlInput1">URL :(OPTIONAL)</label>
      <input type="text" class="form-control" id="url1" placeholder="Default to 'localhost'" name="url">
     </div>
      <div class="form-group">
      <label for="exampleFormControlInput1">MODULE :(OPTIONAL)</label>
      <input type="text" class="form-control" id="module1" placeholder="Default to 'gadwords'" name="module">
      </div>
     <input type="submit" class="btn btn-primary btn-block" value="Lancer le Test" >
          
      </form>
      <br>
      <button class="btn btn-warning btn-block" id="genBtn1" onclick="generateCmd1()">Générer la commande</button>
      </div>


      <div class="tab-pane fade" id="list-profile" role="tabpanel" aria-labelledby="list-profile-list">
      
        <div class="alert alert-danger" role="alert" hidden id="alertId1">
          <h5 class="alert-heading"> <i class="fas fa-exclamation-triangle"></i> Attention!</h5><hr>
Si vous voulez exécuter full /10_module, vous devez définir l'option <b>MODULE</b>
        </div>
      <form action="{{path('prestaShop_test_aff_spec_full')}}" id="divTest" class="form-horizontal">
      <div class="form-group">
       <label for="exampleFormControlSelect1">Path :</label>
         <select class="form-control" id="exampleFormControlSelect1" name="path" onchange="changeFunc()">
        
         <option value="" disabled selected>-- Selectionner le path --</option>
         {% set nb = 1 %}
         {% for path in list %}
           {% set nb = nb + 1 %}
          <option value="{{path}}" id="{{ nb }}">{{path}}</option>
         {% endfor %}
         </select>
      </div>
      <div class="form-group" id="parDIV">
       
      </div>

        <div class="form-group" id="IdDiv">
        <label for="module" id="labMod">MODULE :(OPTIONAL)</label>
        <input type="text" class="form-control" id="module" placeholder="Default to 'gadwords'" name="module">
        </div>

      <div class="form-group">
        <label for="dir">DIR :(REQUIRED)</label>
        <input type="text" class="form-control" id="dir" placeholder="Votre dossier de Téléchargements (exp: /home/toto/Downloads/)" name="dir" required>
       </div>
      
      <div class="form-group">
      <label for="url">URL :(OPTIONAL)</label>
      <input type="text" class="form-control" id="url" placeholder="Default to 'localhost'" name="url">
     </div>
    
     <input type="submit" class="btn btn-primary btn-block" value="Lancer le Test" >
          
      </form>
      <br>
      <button class="btn btn-warning btn-block" id="genBtn" onclick="generateCmd()" disabled>Générer la commande</button>
     
     </div>
      <div class="tab-pane fade" id="list-messages" role="tabpanel" aria-labelledby="list-messages-list">...</div>
     
    </div>
  </div>
</div>


{% endblock %}
